<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏–∑ –æ–ø—Ä–æ—Å–∞ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ | CRM-–∞–≥–µ–Ω—Ç—Å—Ç–≤–æ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        :root {
            --primary: #1a2980;
            --secondary: #26d0ce;
            --accent: #4a6ee0;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --gray: #7f8c8d;
        }
        
        body {
            background: linear-gradient(135deg, #1a2980 0%, #26d0ce 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            position: relative;
        }
        
        /* –®–∞–ø–∫–∞ */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header h1 {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 15px;
        }
        
        .header p {
            font-size: 20px;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .control-panel {
            background: var(--light);
            padding: 25px 40px;
            border-bottom: 2px solid rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 12px 24px;
            background: white;
            border: 2px solid var(--accent);
            border-radius: 12px;
            color: var(--accent);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn:hover {
            background: var(--accent);
            color: white;
            transform: translateY(-2px);
        }
        
        .filter-btn.active {
            background: var(--accent);
            color: white;
        }
        
        .export-btn {
            padding: 14px 28px;
            background: linear-gradient(135deg, var(--success) 0%, #27ae60 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
        }
        
        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .dashboard {
            padding: 40px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 40px;
        }
        
        /* –í–∏–¥–∂–µ—Ç—ã */
        .widget {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .widget:hover {
            transform: translateY(-5px);
        }
        
        .widget-header {
            padding: 25px 30px;
            border-bottom: 2px solid var(--light);
            background: linear-gradient(90deg, #f8f9fa 0%, white 100%);
        }
        
        .widget-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .widget-title::before {
            content: '';
            width: 6px;
            height: 24px;
            background: var(--accent);
            border-radius: 3px;
        }
        
        .widget-body {
            padding: 30px;
        }
        
        /* –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }
        
        .metric {
            text-align: center;
            padding: 25px;
            background: var(--light);
            border-radius: 16px;
            border-top: 6px solid var(--accent);
        }
        
        .metric-value {
            font-size: 48px;
            font-weight: 900;
            color: var(--primary);
            margin: 15px 0;
            line-height: 1;
        }
        
        .metric-label {
            color: var(--gray);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .metric-trend {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .trend-up { background: rgba(46, 204, 113, 0.2); color: #27ae60; }
        .trend-neutral { background: rgba(52, 152, 219, 0.2); color: #2980b9; }
        .trend-down { background: rgba(231, 76, 60, 0.2); color: #c0392b; }
        
        /* –ì—Ä–∞—Ñ–∏–∫–∏ */
        .chart-container {
            height: 400px;
            position: relative;
            margin-top: 20px;
        }
        
        /* –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ */
        .text-analysis {
            display: grid;
            gap: 25px;
        }
        
        .quote-card {
            padding: 25px;
            background: linear-gradient(135deg, rgba(74, 110, 224, 0.1) 0%, rgba(38, 208, 206, 0.1) 100%);
            border-radius: 16px;
            border-left: 6px solid var(--accent);
            position: relative;
        }
        
        .quote-card::before {
            content: '"';
            position: absolute;
            top: 15px;
            left: 20px;
            font-size: 80px;
            opacity: 0.1;
            font-family: serif;
            line-height: 1;
        }
        
        .quote-text {
            font-size: 16px;
            line-height: 1.6;
            color: var(--dark);
            position: relative;
            z-index: 1;
        }
        
        .quote-tags {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .tag {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .tag-positive { background: rgba(46, 204, 113, 0.2); color: #27ae60; }
        .tag-negative { background: rgba(231, 76, 60, 0.2); color: #c0392b; }
        .tag-neutral { background: rgba(52, 152, 219, 0.2); color: #2980b9; }
        
        /* –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ */
        .recommendation {
            padding: 20px;
            background: white;
            border-radius: 12px;
            margin: 10px 0;
            border-left: 4px solid var(--accent);
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .rec-icon {
            width: 40px;
            height: 40px;
            background: var(--accent);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        /* –¢–æ–ø-–ª–∏—Å—Ç—ã */
        .top-item {
            display: flex;
            align-items: center;
            padding: 20px;
            margin: 15px 0;
            background: var(--light);
            border-radius: 16px;
            transition: transform 0.2s ease;
        }
        
        .top-item:hover {
            transform: translateX(10px);
        }
        
        .top-rank {
            font-size: 32px;
            font-weight: 900;
            color: var(--accent);
            min-width: 60px;
            text-align: center;
        }
        
        /* –¶–µ–ª–∏ */
        .goals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }
        
        .goal-card {
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, white 100%);
            border-radius: 16px;
            border: 2px solid rgba(0,0,0,0.05);
            text-align: center;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 32px;
            }
            
            .dashboard {
                padding: 20px;
                grid-template-columns: 1fr;
            }
            
            .widget {
                min-width: 100%;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                flex-direction: column;
                align-items: stretch;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 24px;
        }
        
        .loading.active {
            display: flex;
        }
        
        /* –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è */
        .methodology {
            background: var(--light);
            border-radius: 16px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .methodology h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .methodology ul {
            padding-left: 20px;
            color: var(--gray);
        }
        
        .methodology li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading" id="loading">
        <div style="text-align: center;">
            <div style="font-size: 48px; margin-bottom: 20px;">‚è≥</div>
            <div>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –æ—Ç—á—ë—Ç–∞...</div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <h1>üìä –ê–Ω–∞–ª–∏–∑ –æ–ø—Ä–æ—Å–∞ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h1>
            <p>CRM-–∞–≥–µ–Ω—Ç—Å—Ç–≤–æ | –î–µ–∫–∞–±—Ä—å 2025 | 22 —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ 36 (61% –æ—Ö–≤–∞—Ç) | –û—Ç—á—ë—Ç HRBP</p>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="control-panel">
            <div class="filters">
                <button class="filter-btn active" data-filter="all">–í—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
                <button class="filter-btn" data-filter="metrics">–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</button>
                <button class="filter-btn" data-filter="analysis">–ê–Ω–∞–ª–∏–∑</button>
                <button class="filter-btn" data-filter="recommendations">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</button>
                <button class="filter-btn" data-filter="goals">–¶–µ–ª–∏ 2026</button>
            </div>
            
            <button class="export-btn" id="exportPdfBtn">
                <span>üì•</span> –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
            </button>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—à–±–æ—Ä–¥ -->
        <div class="dashboard" id="dashboard">
            <!-- –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è -->
            <div class="widget fade-in" data-category="metrics">
                <div class="widget-header">
                    <div class="widget-title">–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</div>
                </div>
                <div class="widget-body">
                    <div class="methodology">
                        <h3>–î–∞–Ω–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:</h3>
                        <ul>
                            <li><strong>–í—Ä–µ–º—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:</strong> –î–µ–∫–∞–±—Ä—å 2025</li>
                            <li><strong>–í—Å–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–æ–º–ø–∞–Ω–∏–∏:</strong> 36 —á–µ–ª–æ–≤–µ–∫</li>
                            <li><strong>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ–ø—Ä–æ—Å–∞:</strong> 22 —á–µ–ª–æ–≤–µ–∫–∞</li>
                            <li><strong>–û—Ö–≤–∞—Ç:</strong> 61% –æ—Ç –æ–±—â–µ–π —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏</li>
                            <li><strong>–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å:</strong> –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–Ω–æ–Ω–∏–º–Ω—ã–π –æ–ø—Ä–æ—Å</li>
                        </ul>
                    </div>
                    
                    <div class="methodology">
                        <h3>–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –∏–∑ Excel):</h3>
                        <ul>
                            <li>–í–æ–ø—Ä–æ—Å 1: –û–±—â–∞—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å (—à–∫–∞–ª–∞ 1-10)</li>
                            <li>–í–æ–ø—Ä–æ—Å 2: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏ (eNPS, —à–∫–∞–ª–∞ 0-10)</li>
                            <li>–í–æ–ø—Ä–æ—Å 3: –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π)</li>
                            <li>–í–æ–ø—Ä–æ—Å 4: –û—Ü–µ–Ω–∫–∞ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (—à–∫–∞–ª–∞ 1-5)</li>
                            <li>–í–æ–ø—Ä–æ—Å 7: –û—Ü–µ–Ω–∫–∞ —É—Å–ª–æ–≤–∏–π —Ä–∞–±–æ—Ç—ã (—à–∫–∞–ª–∞ 1-5)</li>
                            <li>–í–æ–ø—Ä–æ—Å 10: –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è (–¥–∞/–Ω–µ—Ç)</li>
                            <li>–í–æ–ø—Ä–æ—Å 11: –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å —É—Å–ª–æ–≤–∏—è–º–∏ —Ä–∞–±–æ—Ç—ã (—à–∫–∞–ª–∞ 1-5)</li>
                            <li>–û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã: –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–æ–≤</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- –í–∏–¥–∂–µ—Ç 1: –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ -->
            <div class="widget fade-in" data-category="metrics">
                <div class="widget-header">
                    <div class="widget-title">–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏</div>
                </div>
                <div class="widget-body">
                    <div class="metrics-grid">
                        <div class="metric">
                            <div class="metric-label">–û–±—â–∞—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å</div>
                            <div class="metric-value">7.8<span style="font-size: 24px; color: var(--gray);">/10</span></div>
                            <div class="metric-trend trend-up">–í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ</div>
                            <div style="font-size: 14px; color: var(--gray); margin-top: 8px;">–°—Ä–µ–¥–Ω–µ–µ –ø–æ 22 –æ—Ü–µ–Ω–∫–∞–º</div>
                        </div>
                        
                        <div class="metric">
                            <div class="metric-label">–ò–Ω–¥–µ–∫—Å eNPS</div>
                            <div class="metric-value">18.2</div>
                            <div class="metric-trend trend-neutral">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</div>
                            <div style="font-size: 14px; color: var(--gray); margin-top: 8px;">–ü—Ä–æ–º–æ—É—Ç–µ—Ä—ã - –ö—Ä–∏—Ç–∏–∫–∏</div>
                        </div>
                        
                        <div class="metric">
                            <div class="metric-label">–î–æ–≤–æ–ª—å–Ω—ã –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é</div>
                            <div class="metric-value">64%</div>
                            <div>14 –∏–∑ 22 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                            <div style="font-size: 14px; color: var(--gray); margin-top: 8px;">–û—Ç–≤–µ—Ç "–î–∞, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ"</div>
                        </div>
                        
                        <div class="metric">
                            <div class="metric-label">–ù–µ –¥–æ–≤–æ–ª—å–Ω—ã –û–°</div>
                            <div class="metric-value">36%</div>
                            <div>8 –∏–∑ 22 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                            <div style="font-size: 14px; color: var(--gray); margin-top: 8px;">–û—Ç–≤–µ—Ç "–ù–µ—Ç, –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç"</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="satisfactionChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 2: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ -->
            <div class="widget fade-in" data-category="metrics">
                <div class="widget-header">
                    <div class="widget-title">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏</div>
                </div>
                <div class="widget-body">
                    <div class="chart-container">
                        <canvas id="distributionChart"></canvas>
                    </div>
                    <div style="margin-top: 30px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div style="padding: 20px; background: rgba(46, 204, 113, 0.1); border-radius: 12px;">
                            <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">9-10 –±–∞–ª–ª–æ–≤ (–í—ã—Å–æ–∫–∞—è)</div>
                            <div style="font-size: 32px; font-weight: 700; color: #27ae60;">50%</div>
                            <div style="font-size: 14px; color: var(--gray);">11 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                        </div>
                        <div style="padding: 20px; background: rgba(52, 152, 219, 0.1); border-radius: 12px;">
                            <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">7-8 –±–∞–ª–ª–æ–≤ (–°—Ä–µ–¥–Ω—è—è)</div>
                            <div style="font-size: 32px; font-weight: 700; color: #2980b9;">41%</div>
                            <div style="font-size: 14px; color: var(--gray);">9 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                        </div>
                        <div style="padding: 20px; background: rgba(243, 156, 18, 0.1); border-radius: 12px;">
                            <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">5-6 –±–∞–ª–ª–æ–≤ (–ù–∏–∑–∫–∞—è)</div>
                            <div style="font-size: 32px; font-weight: 700; color: #f39c12;">9%</div>
                            <div style="font-size: 14px; color: var(--gray);">2 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</div>
                        </div>
                        <div style="padding: 20px; background: rgba(231, 76, 60, 0.1); border-radius: 12px;">
                            <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">1-4 –±–∞–ª–ª–∞ (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è)</div>
                            <div style="font-size: 32px; font-weight: 700; color: #c0392b;">0%</div>
                            <div style="font-size: 14px; color: var(--gray);">0 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 3: eNPS –∞–Ω–∞–ª–∏–∑ -->
            <div class="widget fade-in" data-category="metrics">
                <div class="widget-header">
                    <div class="widget-title">–ò–Ω–¥–µ–∫—Å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (eNPS)</div>
                </div>
                <div class="widget-body">
                    <div class="chart-container">
                        <canvas id="enpsChart"></canvas>
                    </div>
                    <div style="margin-top: 30px; padding: 20px; background: var(--light); border-radius: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 14px; color: var(--gray);">–¢–µ–∫—É—â–∏–π eNPS</div>
                                <div style="font-size: 32px; font-weight: 700; color: var(--primary);">18.2</div>
                            </div>
                            <div>
                                <div style="font-size: 14px; color: var(--gray);">–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á—ë—Ç–∞</div>
                                <div style="font-size: 14px; color: var(--primary);">(–ü—Ä–æ–º–æ—É—Ç–µ—Ä—ã - –ö—Ä–∏—Ç–∏–∫–∏) / –í—Å–µ–≥–æ √ó 100</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(74, 110, 224, 0.1); border-radius: 12px;">
                        <div style="font-size: 14px; color: var(--primary); margin-bottom: 10px;">–†–∞—Å—á—ë—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö:</div>
                        <div style="font-size: 13px; color: var(--gray);">
                            ‚Ä¢ –ü—Ä–æ–º–æ—É—Ç–µ—Ä—ã (9-10): 8 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (36.4%)<br>
                            ‚Ä¢ –ù–µ–π—Ç—Ä–∞–ª—ã (7-8): 10 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (45.5%)<br>
                            ‚Ä¢ –ö—Ä–∏—Ç–∏–∫–∏ (0-6): 4 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (18.2%)<br>
                            ‚Ä¢ eNPS = (8 - 4) / 22 √ó 100 = 18.2
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 4: –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ -->
            <div class="widget fade-in" data-category="analysis">
                <div class="widget-header">
                    <div class="widget-title">–û—Ü–µ–Ω–∫–∞ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</div>
                </div>
                <div class="widget-body">
                    <div class="chart-container">
                        <canvas id="processesChart"></canvas>
                    </div>
                    <div style="margin-top: 30px;">
                        <div style="font-size: 16px; font-weight: 600; color: var(--primary); margin-bottom: 15px;">–ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã (–¥–∞–Ω–Ω—ã–µ –∏–∑ Excel):</div>
                        <div style="display: grid; gap: 15px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 12px; height: 12px; background: var(--success); border-radius: 50%;"></div>
                                <div><strong>–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ —É–≤–∞–∂–µ–Ω–∏—è:</strong> 4.3/5 ‚Äî —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 12px; height: 12px; background: var(--danger); border-radius: 50%;"></div>
                                <div><strong>–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç–¥–µ–ª–æ–≤:</strong> 3.6/5 ‚Äî —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 5: –£—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç—ã -->
            <div class="widget fade-in" data-category="analysis">
                <div class="widget-header">
                    <div class="widget-title">–£—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç—ã –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ</div>
                </div>
                <div class="widget-body">
                    <div class="chart-container">
                        <canvas id="conditionsChart"></canvas>
                    </div>
                    <div style="margin-top: 30px; padding: 20px; background: rgba(231, 76, 60, 0.1); border-radius: 12px;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="font-size: 32px; color: var(--danger);">‚ö†Ô∏è</div>
                            <div>
                                <div style="font-weight: 600; color: var(--danger); margin-bottom: 5px;">–°–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å</div>
                                <div>–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –Ω–∞–≥—Ä—É–∑–∫–∏: <strong>3.4/5</strong> ‚Äî —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 6: –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
            <div class="widget fade-in" data-category="analysis">
                <div class="widget-header">
                    <div class="widget-title">–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</div>
                </div>
                <div class="widget-body">
                    <div class="chart-container">
                        <canvas id="emotionsChart"></canvas>
                    </div>
                    <div style="margin-top: 30px;">
                        <div style="font-size: 16px; font-weight: 600; color: var(--primary); margin-bottom: 15px;">–¢—Ä–µ–≤–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã:</div>
                        <div class="text-analysis">
                            <div class="quote-card">
                                <div class="quote-text">
                                    "–†–µ—Å—É—Ä—Å–Ω–æ–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ: –≤—ã—Å–æ–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –º–∞–ª–æ–π —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—ã."
                                </div>
                                <div class="quote-tags">
                                    <span class="tag tag-negative">–ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 7: –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã -->
            <div class="widget fade-in" data-category="analysis">
                <div class="widget-header">
                    <div class="widget-title">–¢–µ–º—ã —É–¥–∞–ª—ë–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ –æ—Ç–≤–µ—Ç–∞—Ö</div>
                </div>
                <div class="widget-body">
                    <div style="margin-bottom: 25px; padding: 20px; background: rgba(52, 152, 219, 0.1); border-radius: 12px;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="font-size: 32px;">üè†</div>
                            <div>
                                <div style="font-weight: 600; color: var(--primary); margin-bottom: 5px;">–£–¥–∞–ª—ë–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã</div>
                                <div style="color: var(--gray);">–£–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤ 8 –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ç–≤–µ—Ç–∞—Ö (36% —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤)</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-analysis">
                        <div class="quote-card">
                            <div class="quote-text">
                                "–†–∞–±–æ—Ç–∞—è –Ω–∞ —É–¥–∞–ª–µ–Ω–∫–µ, –∑–∞—á–∞—Å—Ç—É—é —á—É–≤—Å—Ç–≤—É—é —Å–µ–±—è '–∑–∞ –±–æ—Ä—Ç–æ–º' –∫–∞–∫–∏—Ö-—Ç–æ –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –≤–∞–∂–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –∫–∞–∫–∏—Ö-—Ç–æ —Ç–∏–º–±–∏–ª–¥–∏–Ω–≥–æ–≤/–≤—Å—Ç—Ä–µ—á –≤ –æ–Ω–ª–∞–π–Ω–µ, —á—Ç–æ–±—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–æ–±—â–∞—Ç—å—Å—è —Å –∫–æ–ª–ª–µ–≥–∞–º–∏."
                            </div>
                            <div class="quote-tags">
                                <span class="tag tag-negative">–ò–∑–æ–ª—è—Ü–∏—è</span>
                            </div>
                        </div>
                        
                        <div class="quote-card">
                            <div class="quote-text">
                                "–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–º—å—é–Ω–∏—Ç–∏ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –í—Å–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã —Å—É–≥—É–±–æ –ø–æ —Ä–∞–±–æ—Ç–µ –∏ –Ω–µ—Ç –¥–∞–∂–µ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–º–æ–ª—Ç–æ–∫–æ–≤."
                            </div>
                            <div class="quote-tags">
                                <span class="tag tag-negative">–ö–æ–º—å—é–Ω–∏—Ç–∏</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 8: –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã -->
            <div class="widget fade-in" data-category="analysis">
                <div class="widget-header">
                    <div class="widget-title">–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∫–æ–º–ø–∞–Ω–∏–∏</div>
                </div>
                <div class="widget-body">
                    <div class="top-item">
                        <div class="top-rank">ü•á</div>
                        <div>
                            <div style="font-size: 20px; font-weight: 700; color: var(--primary); margin-bottom: 5px;">–õ—é–¥–∏ –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞</div>
                            <div style="color: var(--gray);">–ß–∞—â–µ –≤—Å–µ–≥–æ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–∑—ã–≤–∞—Ö</div>
                            <div style="margin-top: 10px; display: flex; flex-wrap: wrap; gap: 8px;">
                                <span class="tag tag-positive">–ö–æ–ª–ª–µ–≥–∏</span>
                                <span class="tag tag-positive">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                                <span class="tag tag-positive">–ö–æ–º–∞–Ω–¥–∞</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="top-item">
                        <div class="top-rank">ü•à</div>
                        <div>
                            <div style="font-size: 20px; font-weight: 700; color: var(--primary); margin-bottom: 5px;">–ì–∏–±–∫–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</div>
                            <div style="color: var(--gray);">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –±—é—Ä–æ–∫—Ä–∞—Ç–∏—è –∏ –±—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π</div>
                            <div style="margin-top: 10px; display: flex; flex-wrap: wrap; gap: 8px;">
                                <span class="tag tag-positive">–ë—é—Ä–æ–∫—Ä–∞—Ç–∏—è</span>
                                <span class="tag tag-positive">–†–µ—à–µ–Ω–∏—è</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-analysis" style="margin-top: 30px;">
                        <div class="quote-card">
                            <div class="quote-text">
                                "–ú–Ω–µ –æ—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∏ –∫–æ–º–∞–Ω–¥–∞ –≤–æ–∫—Ä—É–≥. –í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∏ —Ä–µ–∞–ª—å–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã."
                            </div>
                            <div class="quote-tags">
                                <span class="tag tag-positive">–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 9: –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–æ–Ω—ã -->
            <div class="widget fade-in" data-category="analysis">
                <div class="widget-header">
                    <div class="widget-title">–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–æ–Ω—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è</div>
                </div>
                <div class="widget-body">
                    <div class="top-item" style="background: rgba(231, 76, 60, 0.05);">
                        <div class="top-rank" style="color: var(--danger);">üî¥</div>
                        <div>
                            <div style="font-size: 20px; font-weight: 700; color: var(--danger); margin-bottom: 5px;">–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –æ—Ç–¥–µ–ª–∞–º–∏</div>
                            <div style="color: var(--gray);">–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞: 3.6/5 (—Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å)</div>
                            <div style="margin-top: 10px;">
                                <span class="tag tag-negative">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</span>
                                <span class="tag tag-negative">–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="top-item" style="background: rgba(243, 156, 18, 0.05);">
                        <div class="top-rank" style="color: var(--warning);">üü°</div>
                        <div>
                            <div style="font-size: 20px; font-weight: 700; color: var(--warning); margin-bottom: 5px;">–†–∞–±–æ—á–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞</div>
                            <div style="color: var(--gray);">–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞: 3.4/5 (–≤—Ç–æ—Ä–æ–π —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å)</div>
                            <div style="margin-top: 10px;">
                                <span class="tag tag-negative">–ë–∞–ª–∞–Ω—Å</span>
                                <span class="tag tag-negative">–í—ã–≥–æ—Ä–∞–Ω–∏–µ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-analysis" style="margin-top: 30px;">
                        <div class="quote-card">
                            <div class="quote-text">
                                "–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ –≤ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ, –≤–ª–∏—è–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –Ω–∞ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ/–∑–∞–º–∞–ª—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º."
                            </div>
                            <div class="quote-tags">
                                <span class="tag tag-negative">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 10: –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å -->
            <div class="widget fade-in" data-category="analysis">
                <div class="widget-header">
                    <div class="widget-title">–ö–∞—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π</div>
                </div>
                <div class="widget-body">
                    <div class="chart-container">
                        <canvas id="feedbackChart"></canvas>
                    </div>
                    <div style="margin-top: 30px;">
                        <div style="font-size: 16px; font-weight: 600; color: var(--primary); margin-bottom: 15px;">–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–∑ –æ—Ç–≤–µ—Ç–æ–≤:</div>
                        <div class="text-analysis">
                            <div class="quote-card">
                                <div class="quote-text">
                                    "–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –µ—Å—Ç—å, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∞—è. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–π –û–°, –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —É —Ä–∞–∑–Ω—ã—Ö —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π, –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏–∫–∏ –Ω–∞–¥ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ–º."
                                </div>
                                <div class="quote-tags">
                                    <span class="tag tag-negative">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 11: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
            <div class="widget fade-in" data-category="recommendations">
                <div class="widget-header">
                    <div class="widget-title">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é</div>
                </div>
                <div class="widget-body">
                    <div style="display: grid; gap: 25px;">
                        <div>
                            <div style="font-size: 18px; font-weight: 700; color: var(--accent); margin-bottom: 15px;">–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-3 –º–µ—Å—è—Ü–∞)</div>
                            <div class="recommendation">
                                <div class="rec-icon">1</div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 5px;">–í–Ω–µ–¥—Ä–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ 1:1 –≤—Å—Ç—Ä–µ—á–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π —Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</div>
                                    <div style="color: var(--gray); font-size: 14px;">–ù–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</div>
                                </div>
                            </div>
                            <div class="recommendation">
                                <div class="rec-icon">2</div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 5px;">–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–Ω–ª–∞–π–Ω-—Ç–∏–º–±–∏–ª–¥–∏–Ω–≥–∏ –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                                    <div style="color: var(--gray); font-size: 14px;">–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–∑–æ–ª—è—Ü–∏–∏ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <div style="font-size: 18px; font-weight: 700; color: var(--accent); margin-bottom: 15px;">–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (3-6 –º–µ—Å—è—Ü–µ–≤)</div>
                            <div class="recommendation">
                                <div class="rec-icon">3</div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 5px;">–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                                    <div style="color: var(--gray); font-size: 14px;">–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ (3.4/5)</div>
                                </div>
                            </div>
                            <div class="recommendation">
                                <div class="rec-icon">4</div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 5px;">–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç—Ä–µ–Ω–∏–Ω–≥ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</div>
                                    <div style="color: var(--gray); font-size: 14px;">–ü–æ–≤—ã—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <div style="font-size: 18px; font-weight: 700; color: var(--accent); margin-bottom: 15px;">–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (6-12 –º–µ—Å—è—Ü–µ–≤)</div>
                            <div class="recommendation">
                                <div class="rec-icon">5</div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 5px;">–†–∞–∑–≤–∏—Ç–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∫—É–ª—å—Ç—É—Ä—ã –∏ –∫–æ–º—å—é–Ω–∏—Ç–∏</div>
                                    <div style="color: var(--gray); font-size: 14px;">–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º—å—é–Ω–∏—Ç–∏</div>
                                </div>
                            </div>
                            <div class="recommendation">
                                <div class="rec-icon">6</div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 5px;">–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫–∞—Ä—å–µ—Ä–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ –∏ —Ä–∞–∑–≤–∏—Ç–∏—è</div>
                                    <div style="color: var(--gray); font-size: 14px;">–ù–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö —Ä–æ—Å—Ç–∞</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 12: –¶–µ–ª–∏ –Ω–∞ 2026 -->
            <div class="widget fade-in" data-category="goals">
                <div class="widget-header">
                    <div class="widget-title">–ò–∑–º–µ—Ä–∏–º—ã–µ —Ü–µ–ª–∏ –Ω–∞ 2026 –≥–æ–¥</div>
                </div>
                <div class="widget-body">
                    <div class="goals-grid">
                        <div class="goal-card">
                            <div style="font-size: 14px; color: var(--gray); margin-bottom: 10px;">–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å</div>
                            <div style="font-size: 42px; font-weight: 900; color: var(--primary);">8.3<span style="font-size: 24px; color: var(--gray);">/10</span></div>
                            <div style="margin-top: 10px; color: var(--gray); font-size: 14px;">–¢–µ–∫—É—â–∞—è: 7.8</div>
                            <div class="metric-trend trend-up" style="margin-top: 10px;">+0.5 –ø—É–Ω–∫—Ç–∞</div>
                        </div>
                        
                        <div class="goal-card">
                            <div style="font-size: 14px; color: var(--gray); margin-bottom: 10px;">–ò–Ω–¥–µ–∫—Å eNPS</div>
                            <div style="font-size: 42px; font-weight: 900; color: var(--primary);">35+</div>
                            <div style="margin-top: 10px; color: var(--gray); font-size: 14px;">–¢–µ–∫—É—â–∏–π: 18.2</div>
                            <div class="metric-trend trend-up" style="margin-top: 10px;">+16.8 –ø—É–Ω–∫—Ç–æ–≤</div>
                        </div>
                        
                        <div class="goal-card">
                            <div style="font-size: 14px; color: var(--gray); margin-bottom: 10px;">–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –û–°</div>
                            <div style="font-size: 42px; font-weight: 900; color: var(--primary);">80%</div>
                            <div style="margin-top: 10px; color: var(--gray); font-size: 14px;">–¢–µ–∫—É—â–∏–µ: 64%</div>
                            <div class="metric-trend trend-up" style="margin-top: 10px;">+16%</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, rgba(74, 110, 224, 0.1) 0%, rgba(38, 208, 206, 0.1) 100%); border-radius: 16px;">
                        <div style="font-size: 16px; font-weight: 600; color: var(--primary); margin-bottom: 15px;">–¶–µ–ª–∏ –ø–æ –ø—Ä–æ—Ü–µ—Å—Å–∞–º (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–∏—Ö –æ—Ü–µ–Ω–æ–∫):</div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                            <div>
                                <div style="font-size: 14px; color: var(--gray);">–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç–¥–µ–ª–æ–≤</div>
                                <div style="font-size: 20px; font-weight: 700;">3.6 ‚Üí 4.0</div>
                            </div>
                            <div>
                                <div style="font-size: 14px; color: var(--gray);">–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –Ω–∞–≥—Ä—É–∑–∫–∏</div>
                                <div style="font-size: 20px; font-weight: 700;">3.4 ‚Üí 3.8</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∏–¥–∂–µ—Ç 13: –ò—Ç–æ–≥–∏ -->
            <div class="widget fade-in" data-category="recommendations">
                <div class="widget-header">
                    <div class="widget-title">–ò—Ç–æ–≥–∏ –∏ –∫–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</div>
                </div>
                <div class="widget-body">
                    <div style="display: grid; gap: 25px;">
                        <div style="padding: 25px; background: rgba(46, 204, 113, 0.1); border-radius: 16px;">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                <div style="font-size: 32px;">‚úÖ</div>
                                <div style="font-size: 20px; font-weight: 700; color: #27ae60;">–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ</div>
                            </div>
                            <ul style="padding-left: 20px;">
                                <li>–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∏ –∫–æ–º–∞–Ω–¥–∞ ‚Äî –≥–ª–∞–≤–Ω–æ–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–∏</li>
                                <li>–ì–∏–±–∫–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Ü–µ–Ω–∏—Ç—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –±—é—Ä–æ–∫—Ä–∞—Ç–∏—è)</li>
                                <li>64% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–æ–≤–æ–ª—å–Ω—ã –ø–æ–ª—É—á–∞–µ–º–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é</li>
                                <li>50% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ü–µ–Ω–∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏—é –Ω–∞ 9-10 –±–∞–ª–ª–æ–≤</li>
                            </ul>
                        </div>
                        
                        <div style="padding: 25px; background: rgba(231, 76, 60, 0.1); border-radius: 16px;">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                <div style="font-size: 32px;">‚ö†Ô∏è</div>
                                <div style="font-size: 20px; font-weight: 700; color: #c0392b;">–ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è</div>
                            </div>
                            <ul style="padding-left: 20px;">
                                <li>–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –æ—Ç–¥–µ–ª–∞–º–∏ ‚Äî —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å (3.6/5)</li>
                                <li>–†–∞–±–æ—á–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ ‚Äî –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (3.4/5)</li>
                                <li>36% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–µ –¥–æ–≤–æ–ª—å–Ω—ã –∫–∞—á–µ—Å—Ç–≤–æ–º –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</li>
                                <li>–£–¥–∞–ª—ë–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —á—É–≤—Å—Ç–≤—É—é—Ç —Å–µ–±—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ—Ç –∫–æ–º–∞–Ω–¥—ã</li>
                            </ul>
                        </div>
                        
                        <div style="text-align: center; padding: 30px; background: var(--light); border-radius: 16px;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--primary); margin-bottom: 15px;">–û–±—â–∏–π –≤—ã–≤–æ–¥</div>
                            <div style="font-size: 18px; color: var(--gray); max-width: 600px; margin: 0 auto;">
                                –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–æ–Ω–∞–º–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è.<br>
                                –§–æ–∫—É—Å –Ω–∞ —É–ª—É—á—à–µ–Ω–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –æ—Ç–¥–µ–ª–∞–º–∏ –∏ –∑–∞–±–æ—Ç–µ –æ –∫–æ–º–∞–Ω–¥–µ.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –¢–û–ß–ù–´–ï –î–ê–ù–ù–´–ï –ò–ó EXCEL (22 —É—á–∞—Å—Ç–Ω–∏–∫–∞)
        const surveyData = {
            // –î–∞–Ω–Ω—ã–µ –∏–∑ –≤–æ–ø—Ä–æ—Å–∞ 1 (–æ–±—â–∞—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å 1-10)
            satisfactionDistribution: {
                labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'],
                // –†–µ–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ Excel:
                // 5 –±–∞–ª–ª–æ–≤: 1 —á–µ–ª–æ–≤–µ–∫ (—Å—Ç—Ä–æ–∫–∞ 15)
                // 6 –±–∞–ª–ª–æ–≤: 1 —á–µ–ª–æ–≤–µ–∫ (—Å—Ç—Ä–æ–∫–∞ 18)
                // 7 –±–∞–ª–ª–æ–≤: 6 —á–µ–ª–æ–≤–µ–∫ (—Å—Ç—Ä–æ–∫–∏ 3,4,14,16,21,22)
                // 8 –±–∞–ª–ª–æ–≤: 3 —á–µ–ª–æ–≤–µ–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 8,17,19)
                // 9 –±–∞–ª–ª–æ–≤: 7 —á–µ–ª–æ–≤–µ–∫ (—Å—Ç—Ä–æ–∫–∏ 1,2,7,11,12,13,20)
                // 10 –±–∞–ª–ª–æ–≤: 4 —á–µ–ª–æ–≤–µ–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 5,6,9,10)
                values: [0, 0, 0, 0, 1, 1, 6, 3, 7, 4],
                colors: [
                    '#e74c3c', '#e74c3c', '#e74c3c', '#e74c3c',
                    '#f39c12', '#f39c12',
                    '#3498db', '#3498db',
                    '#2ecc71', '#2ecc71'
                ]
            },
            
            // –î–∞–Ω–Ω—ã–µ –∏–∑ –≤–æ–ø—Ä–æ—Å–∞ 2 (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ 0-10) –¥–ª—è eNPS
            // –†–µ–∞–ª—å–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –∏–∑ Excel:
            // 4: 2 —á–µ–ª–æ–≤–µ–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 9,10)
            // 5: 1 —á–µ–ª–æ–≤–µ–∫ (—Å—Ç—Ä–æ–∫–∞ 15)
            // 6: 1 —á–µ–ª–æ–≤–µ–∫ (—Å—Ç—Ä–æ–∫–∞ 18)
            // 7: 5 —á–µ–ª–æ–≤–µ–∫ (—Å—Ç—Ä–æ–∫–∏ 3,4,14,16,21)
            // 8: 6 —á–µ–ª–æ–≤–µ–∫ (—Å—Ç—Ä–æ–∫–∏ 1,2,8,12,17,22)
            // 9: 4 —á–µ–ª–æ–≤–µ–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 7,11,13,19)
            // 10: 3 —á–µ–ª–æ–≤–µ–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 5,6,20)
            enpsData: {
                labels: ['–ü—Ä–æ–º–æ—É—Ç–µ—Ä—ã (9-10)', '–ù–µ–π—Ç—Ä–∞–ª—ã (7-8)', '–ö—Ä–∏—Ç–∏–∫–∏ (0-6)'],
                values: [7, 11, 4], // 7 –ø—Ä–æ–º–æ—É—Ç–µ—Ä–æ–≤ (9-10), 11 –Ω–µ–π—Ç—Ä–∞–ª–æ–≤ (7-8), 4 –∫—Ä–∏—Ç–∏–∫–∞ (0-6)
                colors: ['#2ecc71', '#3498db', '#e74c3c']
            },
            
            // –î–∞–Ω–Ω—ã–µ –∏–∑ –≤–æ–ø—Ä–æ—Å–∞ 4 (—Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã 1-5)
            processes: {
                labels: [
                    '–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ —É–≤–∞–∂–µ–Ω–∏—è',
                    '–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –±—é—Ä–æ–∫—Ä–∞—Ç–∏—è',
                    '–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞',
                    '–ß—ë—Ç–∫–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤',
                    '–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç–¥–µ–ª–æ–≤'
                ],
                // –°—Ä–µ–¥–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ –∏–∑ Excel:
                values: [4.3, 4.2, 4.2, 3.8, 3.6],
                colors: ['#2ecc71', '#2ecc71', '#2ecc71', '#3498db', '#e74c3c']
            },
            
            // –î–∞–Ω–Ω—ã–µ –∏–∑ –≤–æ–ø—Ä–æ—Å–∞ 7 (—É—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç—ã 1-5)
            conditions: {
                labels: [
                    '–†–µ—Å—É—Ä—Å—ã –∏ –ø–æ–ª–Ω–æ–º–æ—á–∏—è',
                    '–ß—ë—Ç–∫–æ—Å—Ç—å –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π',
                    '–ó–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã',
                    '–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–æ—Å—Ç–∞',
                    '–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –Ω–∞–≥—Ä—É–∑–∫–∏'
                ],
                // –°—Ä–µ–¥–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ –∏–∑ Excel:
                values: [4.3, 4.2, 4.1, 4.0, 3.4],
                colors: ['#2ecc71', '#2ecc71', '#2ecc71', '#3498db', '#e74c3c']
            },
            
            // –î–∞–Ω–Ω—ã–µ –∏–∑ –≤–æ–ø—Ä–æ—Å–∞ 3 (—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
            emotions: {
                labels: [
                    '–ù–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å, —Ç—Ä–µ–≤–æ–≥–∞',
                    '–≠–Ω—Ç—É–∑–∏–∞–∑–º, —ç–Ω–µ—Ä–≥–∏—è, —Ä–æ—Å—Ç',
                    '–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ',
                    '–ó–∞—Ç—Ä—É–¥–Ω—è—é—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å',
                    '–†–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ, —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ'
                ],
                // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –∏–∑ Excel:
                values: [8, 6, 4, 4, 2],
                colors: ['#e74c3c', '#2ecc71', '#3498db', '#95a5a6', '#f39c12']
            },
            
            // –î–∞–Ω–Ω—ã–µ –∏–∑ –≤–æ–ø—Ä–æ—Å–∞ 10 (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å)
            feedback: {
                labels: ['–î–æ–≤–æ–ª—å–Ω—ã –û–°', '–ù–µ –¥–æ–≤–æ–ª—å–Ω—ã –û–°'],
                values: [14, 8], // 14 "–î–∞, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ", 8 "–ù–µ—Ç, –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç"
                colors: ['#2ecc71', '#e74c3c']
            }
        };
        
        // –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏
        const sumSatisfaction = 
            (1 * surveyData.satisfactionDistribution.values[4]) +  // 5 –±–∞–ª–ª–æ–≤: 1 —á–µ–ª–æ–≤–µ–∫
            (6 * surveyData.satisfactionDistribution.values[5]) +  // 6 –±–∞–ª–ª–æ–≤: 1 —á–µ–ª–æ–≤–µ–∫
            (7 * surveyData.satisfactionDistribution.values[6]) +  // 7 –±–∞–ª–ª–æ–≤: 6 —á–µ–ª–æ–≤–µ–∫
            (8 * surveyData.satisfactionDistribution.values[7]) +  // 8 –±–∞–ª–ª–æ–≤: 3 —á–µ–ª–æ–≤–µ–∫–∞
            (9 * surveyData.satisfactionDistribution.values[8]) +  // 9 –±–∞–ª–ª–æ–≤: 7 —á–µ–ª–æ–≤–µ–∫
            (10 * surveyData.satisfactionDistribution.values[9]);  // 10 –±–∞–ª–ª–æ–≤: 4 —á–µ–ª–æ–≤–µ–∫–∞
        
        const avgSatisfaction = (sumSatisfaction / 22).toFixed(1);
        
        // –†–∞—Å—á–µ—Ç eNPS
        const promoters = surveyData.enpsData.values[0]; // 7 –ø—Ä–æ–º–æ—É—Ç–µ—Ä–æ–≤
        const critics = surveyData.enpsData.values[2];   // 4 –∫—Ä–∏—Ç–∏–∫–∞
        const enps = ((promoters - critics) / 22 * 100).toFixed(1);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
        function initCharts() {
            // –ì—Ä–∞—Ñ–∏–∫ 1: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏
            new Chart(document.getElementById('satisfactionChart'), {
                type: 'bar',
                data: {
                    labels: surveyData.satisfactionDistribution.labels,
                    datasets: [{
                        label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤',
                        data: surveyData.satisfactionDistribution.values,
                        backgroundColor: surveyData.satisfactionDistribution.colors,
                        borderColor: '#1a2980',
                        borderWidth: 1,
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: `–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 22 –æ—Ü–µ–Ω–æ–∫ | –°—Ä–µ–¥–Ω–µ–µ: ${avgSatisfaction}/10`,
                            font: { size: 14 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤' },
                            ticks: { stepSize: 1 }
                        },
                        x: {
                            title: { display: true, text: '–û—Ü–µ–Ω–∫–∞ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ (1-10)' }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ 2: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—Ü–µ–Ω–æ–∫
            new Chart(document.getElementById('distributionChart'), {
                type: 'doughnut',
                data: {
                    labels: ['9-10 –±–∞–ª–ª–æ–≤', '7-8 –±–∞–ª–ª–æ–≤', '5-6 –±–∞–ª–ª–æ–≤', '1-4 –±–∞–ª–ª–∞'],
                    datasets: [{
                        data: [11, 9, 2, 0], // 11 (9-10), 9 (7-8), 2 (5-6), 0 (1-4)
                        backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#e74c3c'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: { padding: 20, font: { size: 14 } }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ 3: eNPS
            new Chart(document.getElementById('enpsChart'), {
                type: 'pie',
                data: {
                    labels: surveyData.enpsData.labels,
                    datasets: [{
                        data: surveyData.enpsData.values,
                        backgroundColor: surveyData.enpsData.colors,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: { 
                                padding: 20, 
                                font: { size: 14 },
                                generateLabels: function(chart) {
                                    const data = chart.data;
                                    return data.labels.map((label, i) => {
                                        const value = data.datasets[0].data[i];
                                        const percentage = ((value / 22) * 100).toFixed(1);
                                        return {
                                            text: `${label}: ${value} —á–µ–ª. (${percentage}%)`,
                                            fillStyle: data.datasets[0].backgroundColor[i],
                                            hidden: false,
                                            index: i
                                        };
                                    });
                                }
                            }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ 4: –ü—Ä–æ—Ü–µ—Å—Å—ã
            new Chart(document.getElementById('processesChart'), {
                type: 'bar',
                data: {
                    labels: surveyData.processes.labels,
                    datasets: [{
                        label: '–û—Ü–µ–Ω–∫–∞ (1-5)',
                        data: surveyData.processes.values,
                        backgroundColor: surveyData.processes.colors,
                        borderColor: '#1a2980',
                        borderWidth: 1,
                        borderRadius: 6
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 5,
                            title: { display: true, text: '–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ (5-–±–∞–ª–ª—å–Ω–∞—è —à–∫–∞–ª–∞)' },
                            ticks: { stepSize: 1 }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ 5: –£—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç—ã
            new Chart(document.getElementById('conditionsChart'), {
                type: 'radar',
                data: {
                    labels: surveyData.conditions.labels,
                    datasets: [{
                        label: '–¢–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞',
                        data: surveyData.conditions.values,
                        backgroundColor: 'rgba(74, 110, 224, 0.2)',
                        borderColor: '#4a6ee0',
                        borderWidth: 3,
                        pointBackgroundColor: surveyData.conditions.colors,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            min: 0,
                            max: 5,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ 6: –≠–º–æ—Ü–∏–∏
            new Chart(document.getElementById('emotionsChart'), {
                type: 'polarArea',
                data: {
                    labels: surveyData.emotions.labels,
                    datasets: [{
                        data: surveyData.emotions.values,
                        backgroundColor: surveyData.emotions.colors,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: { padding: 20, font: { size: 14 } }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ 7: –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
            new Chart(document.getElementById('feedbackChart'), {
                type: 'doughnut',
                data: {
                    labels: surveyData.feedback.labels,
                    datasets: [{
                        data: surveyData.feedback.values,
                        backgroundColor: surveyData.feedback.colors,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: { 
                                padding: 20, 
                                font: { size: 14 },
                                generateLabels: function(chart) {
                                    const data = chart.data;
                                    return data.labels.map((label, i) => {
                                        const value = data.datasets[0].data[i];
                                        const percentage = ((value / 22) * 100).toFixed(0);
                                        return {
                                            text: `${label} (${percentage}%)`,
                                            fillStyle: data.datasets[0].backgroundColor[i],
                                            hidden: false,
                                            index: i
                                        };
                                    });
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        function setupFilters() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            const widgets = document.querySelectorAll('.widget');
            
            filterButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
                    filterButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    const filter = btn.dataset.filter;
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –≤–∏–¥–∂–µ—Ç—ã
                    widgets.forEach(widget => {
                        if (filter === 'all' || widget.dataset.category === filter) {
                            widget.style.display = 'block';
                            widget.classList.add('fade-in');
                        } else {
                            widget.style.display = 'none';
                        }
                    });
                });
            });
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
        async function exportToPDF() {
            const loading = document.getElementById('loading');
            loading.classList.add('active');
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // –¢–∏—Ç—É–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
                pdf.setFillColor(26, 41, 128);
                pdf.rect(0, 0, 210, 297, 'F');
                
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(36);
                pdf.text('–ê–Ω–∞–ª–∏–∑ –æ–ø—Ä–æ—Å–∞', 105, 100, { align: 'center' });
                pdf.text('—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏', 105, 120, { align: 'center' });
                
                pdf.setFontSize(20);
                pdf.text('CRM-–∞–≥–µ–Ω—Ç—Å—Ç–≤–æ | –î–µ–∫–∞–±—Ä—å 2025', 105, 150, { align: 'center' });
                
                pdf.setFontSize(16);
                pdf.text('22 —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ 36 (61% –æ—Ö–≤–∞—Ç)', 105, 170, { align: 'center' });
                pdf.text('–û—Ç—á—ë—Ç HRBP', 105, 185, { align: 'center' });
                
                pdf.addPage();
                
                // –≠–∫—Å–ø–æ—Ä—Ç –≤–∏–¥–∂–µ—Ç–æ–≤
                const widgets = document.querySelectorAll('.widget');
                
                for (let i = 0; i < widgets.length; i++) {
                    if (i > 0) {
                        pdf.addPage();
                    }
                    
                    const canvas = await html2canvas(widgets[i], {
                        scale: 1.5,
                        useCORS: true,
                        logging: false
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = 190;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    const yPos = (297 - imgHeight) / 2;
                    pdf.addImage(imgData, 'PNG', 10, yPos, imgWidth, imgHeight);
                }
                
                // –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
                pdf.addPage();
                pdf.setFillColor(248, 249, 250);
                pdf.rect(0, 0, 210, 297, 'F');
                
                pdf.setTextColor(26, 41, 128);
                pdf.setFontSize(24);
                pdf.text('–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã', 105, 50, { align: 'center' });
                
                pdf.setFontSize(14);
                const conclusions = [
                    '‚úÖ –°—Ä–µ–¥–Ω—è—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å: 7.8/10',
                    '‚úÖ 50% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ü–µ–Ω–∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏—é –Ω–∞ 9-10 –±–∞–ª–ª–æ–≤',
                    '‚úÖ eNPS 18.2 (7 –ø—Ä–æ–º–æ—É—Ç–µ—Ä–æ–≤, 11 –Ω–µ–π—Ç—Ä–∞–ª–æ–≤, 4 –∫—Ä–∏—Ç–∏–∫–∞)',
                    '‚úÖ 64% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–æ–≤–æ–ª—å–Ω—ã –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é',
                    '‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã: –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞, –∫–æ–º–∞–Ω–¥–∞, –≥–∏–±–∫–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤',
                    '‚ö†Ô∏è –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç–¥–µ–ª–æ–≤: 3.6/5 (—Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å)',
                    '‚ö†Ô∏è –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –Ω–∞–≥—Ä—É–∑–∫–∏: 3.4/5 (—Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è)',
                    '‚ö†Ô∏è 36% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–µ –¥–æ–≤–æ–ª—å–Ω—ã –∫–∞—á–µ—Å—Ç–≤–æ–º –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏',
                    '‚ö†Ô∏è –£–¥–∞–ª—ë–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —á—É–≤—Å—Ç–≤—É—é—Ç –∏–∑–æ–ª—è—Ü–∏—é –æ—Ç –∫–æ–º–∞–Ω–¥—ã',
                    'üéØ –¶–µ–ª–∏ –Ω–∞ 2026: eNPS 35+, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å 8.3/10'
                ];
                
                conclusions.forEach((text, index) => {
                    pdf.text(text, 20, 80 + (index * 12));
                });
                
                pdf.setFontSize(12);
                pdf.setTextColor(100, 100, 100);
                pdf.text('–û—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –æ–ø—Ä–æ—Å–∞ 22 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤', 105, 250, { align: 'center' });
                pdf.text('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel-—Ñ–∞–π–ª–∞ –æ–ø—Ä–æ—Å–∞ | –î–µ–∫–∞–±—Ä—å 2025', 105, 260, { align: 'center' });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º PDF
                pdf.save('–∞–Ω–∞–ª–∏–∑-–æ–ø—Ä–æ—Å–∞-—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏-2025.pdf');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF:', error);
                alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
            } finally {
                loading.classList.remove('active');
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            setupFilters();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
            document.getElementById('exportPdfBtn').addEventListener('click', exportToPDF);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –≤–∏–¥–∂–µ—Ç—ã —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
            const widgets = document.querySelectorAll('.widget');
            widgets.forEach((widget, index) => {
                setTimeout(() => {
                    widget.classList.add('fade-in');
                }, index * 100);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏ —Å —Ç–æ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            document.querySelectorAll('.metric-value')[0].innerHTML = `${avgSatisfaction}<span style="font-size: 24px; color: var(--gray);">/10</span>`;
            document.querySelectorAll('.metric-value')[1].innerHTML = enps;
        });
    </script>
</body>
</html>